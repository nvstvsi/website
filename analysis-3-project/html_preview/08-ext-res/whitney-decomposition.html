<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>whitney-decomposition</title>
  <script>
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      displayMath: [['$$', '$$'], ['\\[', '\\]']],
      processEscapes: true,
      processEnvironments: true,
      tags: 'ams',
      tagSide: 'right',
      tagIndent: '0.8em',
      packages: {'[+]': ['ams']},
      macros: {
        R: '\\mathbb{R}',
        C: '\\mathbb{C}',
        N: '\\mathbb{N}',
        Z: '\\mathbb{Z}',
        Q: '\\mathbb{Q}',
        E: '\\mathbb{E}',
        F: '\\mathbb{F}',
        S: '\\mathbb{S}',
        H: '\\mathcal{H}',
        L: '\\mathcal{L}',
        dif: '\\,\\mathrm{d}',
        supp: '\\operatorname{supp}',
        proj: '\\operatorname{proj}',
        Id: '\\operatorname{Id}',
        Span: '\\operatorname{span}',
        graph: '\\operatorname{graph}',
        dist: '\\operatorname{dist}',
        diam: '\\operatorname{diam}',
        avg: '\\operatorname{avg}',
        div: '\\operatorname{div}',
        vol: '\\operatorname{vol}',
        ord: '\\operatorname{ord}',
        Chi: '\\mathbf{1}',
        sub: '\\subseteq',
        mres: '\\downharpoonright',
        ddag: '\\ddagger',
        dag: '\\dagger',
        norm: ['\\left\\| #1 \\right\\|', 1],
        abs: ['\\left| #1 \\right|', 1],
        set: ['\\left\\{ #1 \\right\\}', 1],
        inner: ['\\langle #1, #2 \\rangle', 2],
        floor: ['\\lfloor #1 \\rfloor', 1],
        ceil: ['\\lceil #1 \\rceil', 1],
        llbracket: '\\unicode{x27E6}',
        rrbracket: '\\unicode{x27E7}',
        bigskull: '\\unicode{x1F480}',
        skull: '\\unicode{x2620}',
        mathwitch: '\\unicode{x1F9D9}',
        pumpkin: '\\unicode{x1F383}',
        mathpumpkin: '\\unicode{x1F383}',
        bigpumpkin: '\\unicode{x1F383}',
        mathghost: '\\unicode{x1F47B}',
        mathcat: '\\unicode{x1F408}',
        mathbat: '\\unicode{x1F987}',
        esssup: '\\operatorname{ess\\,sup}',
        essinf: '\\operatorname{ess\\,inf}',
        Lip: '\\operatorname{Lip}',
        pd: ['\\frac{\\partial#1}{\\partial#2}', 2],
        od: ['\\frac{\\mathrm{d}#1}{\\mathrm{d}#2}', 2],
        dashint: '\\mathchoice{\\rlap{-}\\!\\int}{\\rlap{\\raise.15ex\\hbox{\\smash{\\scriptscriptstyle-}}}\\int}{\\rlap{\\raise.09ex\\hbox{\\smash{\\scriptscriptstyle-}}}\\int}{\\rlap{\\raise.09ex\\hbox{\\smash{\\scriptscriptstyle-}}}\\int}',
        eurologo: '\\unicode{x20AC}',
        starredbullet: '\\unicode{x2726}',
        grimace: '\\unicode{x1F62C}',
        textthing: '\\unicode{x2639}',
        noway: '\\unicode{x26D4}',
        warning: '\\unicode{x26A0}',
        danger: '\\unicode{x26A0}',
        textxswup: '\\unicode{x2195}',
        textxswdown: '\\unicode{x2195}',
        decoone: '\\unicode{x2756}',
        decotwo: '\\unicode{x2767}',
        decothreeleft: '\\unicode{x2619}',
        decothreeright: '\\unicode{x2767}',
        decofourleft: '\\unicode{x261A}',
        decofourright: '\\unicode{x261B}',
        floweroneleft: '\\unicode{x2740}',
        floweroneright: '\\unicode{x2740}',
        lefthand: '\\unicode{x261C}',
        righthand: '\\unicode{x261E}',
        decosix: '\\unicode{x2766}',
        bomb: '\\unicode{x1F4A3}',
        caution: '\\unicode{x2621}',
        leftblackhand: '\\unicode{x261A}',
        rightblackhand: '\\unicode{x261B}',
        leafleft: '\\unicode{x2618}',
        leafright: '\\unicode{x2618}',
        leafNW: '\\unicode{x2618}',
        leafNE: '\\unicode{x2618}',
        leafSE: '\\unicode{x2618}',
        leafSW: '\\unicode{x2618}',
        aldineleft: '\\unicode{x2619}',
        aldineright: '\\unicode{x2767}',
        aldine: '\\unicode{x2766}',
        aldinesmall: '\\unicode{x2767}',
        aldinesmallrevert: '\\unicode{x2619}',
        aldinesmallup: '\\unicode{x2766}',
        grappe: '\\unicode{x2766}',
        rightgrappe: '\\unicode{x2767}',
        leftgrappe: '\\unicode{x2619}',
        oldpilcrowone: '\\unicode{x00B6}',
        oldpilcrowtwo: '\\unicode{x00B6}',
        oldpilcrowthree: '\\unicode{x00B6}',
        oldpilcrowfour: '\\unicode{x00B6}',
        oldpilcrowfive: '\\unicode{x00B6}',
        oldpilcrowsix: '\\unicode{x00B6}'
      }
    },
    startup: {
      pageReady: () => {
        return MathJax.startup.defaultPageReady().then(() => {
          console.log('MathJax ready');
        });
      }
    }
  };
  </script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" id="MathJax-script"></script>
  <script>
  (function() {
    window.addEventListener('beforeunload', function() {
      saveProofState();
      saveCollapsibleState();
    });
    
    const eventSource = new EventSource('http://localhost:35729/reload-stream');
    
    eventSource.onmessage = function(event) {
      if (event.data === 'reload') {
        console.log('üìù File updated, saving state and reloading...');
        saveProofState();
        saveCollapsibleState();
        setTimeout(() => {
          window.location.reload();
        }, 50);
      }
    };
    
    eventSource.onerror = function() {
      console.log('‚ö†Ô∏è  Auto-reload server not available. Run node watch.js to enable auto-reload.');
      eventSource.close();
    };
    
    console.log('üîÑ Auto-reload enabled');
  })();
  </script>
  <style>
    * { box-sizing: border-box; }
    
    body {
      font-family: Georgia, "Times New Roman", serif;
      font-size: 16px;
      line-height: 1.7;
      margin: 0;
      padding: 0;
      color: #1a1a1a;
      background: #ffffff;
    }
    
    /* Layout with sidebar */
    .page-layout {
      display: flex;
      min-height: 100vh;
    }
    
    /* Sidebar styles */
    .sidebar {
      width: 280px;
      background: #fff;
      border-right: 1px solid #e0e0e0;
      position: fixed;
      top: 0;
      left: 0;
      height: 100vh;
      overflow-y: auto;
      padding: 20px 0;
      font-size: 14px;
    }
    
    .sidebar-header {
      padding: 15px 20px 25px;
      border-bottom: 1px solid #e0e0e0;
    }
    
    .sidebar-header h1 {
      font-size: 1.3em;
      font-weight: 600;
      color: #1a1a1a;
      margin: 0 0 5px 0;
    }
    
    .sidebar-header .subtitle {
      font-size: 0.85em;
      color: #666;
      font-style: italic;
    }
    
    .sidebar-header .back-link {
      display: block;
      font-size: 0.8em;
      color: #666;
      text-decoration: none;
      margin-top: 12px;
    }
    
    .sidebar-header .back-link:hover {
      color: #1a1a1a;
    }
    
    .sidebar-nav {
      padding: 10px 0;
    }
    
    .chapter-group {
      margin-bottom: 2px;
    }
    
    .chapter-title {
      padding: 12px 20px;
      font-size: 0.9em;
      font-weight: 600;
      color: #333;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .chapter-title:hover {
      background: #f5f5f5;
    }
    
    .chapter-title .toggle {
      font-size: 0.65em;
      color: #999;
      transition: transform 0.2s;
    }
    
    .chapter-group.expanded .chapter-title .toggle {
      transform: rotate(90deg);
    }
    
    .section-list {
      display: none;
      padding: 5px 0;
      background: #f8f8f8;
    }
    
    .chapter-group.expanded .section-list {
      display: block;
    }
    
    .section-link {
      display: block;
      padding: 8px 20px 8px 35px;
      font-size: 0.85em;
      color: #555;
      text-decoration: none;
      border-left: 3px solid transparent;
    }
    
    .section-link:hover {
      background: #f0f0f0;
      color: #1a1a1a;
    }
    
    .section-link.active {
      background: #e8e8e8;
      border-left-color: #333;
      color: #000;
      font-weight: 500;
    }
    
    /* Main content area */
    .main-content {
      margin-left: 280px;
      flex: 1;
      max-width: 900px;
      padding: 40px 60px;
    }
    
    @media (max-width: 1100px) {
      .sidebar {
        width: 240px;
      }
      .main-content {
        margin-left: 240px;
        padding: 30px 40px;
      }
    }
    
    @media (max-width: 800px) {
      .sidebar {
        position: relative;
        width: 100%;
        height: auto;
        border-right: none;
        border-bottom: 1px solid #e0e0e0;
      }
      .main-content {
        margin-left: 0;
        padding: 20px;
      }
      .page-layout {
        flex-direction: column;
      }
    }
    
    h2, h3, h4 {
      margin-top: 2em;
      margin-bottom: 0.75em;
      color: #000;
      font-weight: 600;
    }
    h2 { font-size: 1.5em; border-bottom: 1px solid #e0e0e0; padding-bottom: 0.3em; }
    h3 { font-size: 1.25em; }
    h4 { font-size: 1.1em; }
    p {
      margin: 1em 0;
      text-indent: 2em;
    }
    p:first-of-type,
    h2 + p,
    h3 + p,
    h4 + p,
    .theorem-box + p,
    .proof-box + p {
      text-indent: 0;
    }
    .noindent + p,
    p:has(> .noindent:first-child) {
      text-indent: 0 !important;
    }
    .noindent {
      display: none;
    }
    .theorem-box {
      margin: 1.75em 0;
      padding: 1.25em;
      border-left: 5px solid #16a34a;
      background: linear-gradient(to top, #bbf7d0 0%, #d1fae5 100%);
      border-radius: 6px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.05);
    }
    .definition-box { border-left-color: #16a34a; background: linear-gradient(to top, #d1fae5 0%, #ecfdf5 100%); }
    .lemma-box { border-left-color: #1e3a8a; background: linear-gradient(to top, #bfdbfe 0%, #dbeafe 100%); }
    .corollary-box { border-left-color: #9333ea; background: linear-gradient(to top, #e9d5ff 0%, #f3e8ff 100%); }
    .proposition-box { border-left-color: #dc2626; background: linear-gradient(to top, #fecaca 0%, #fee2e2 100%); }
    .remark-box { border-left-color: #64748b; background: linear-gradient(to top, #e2e8f0 0%, #f1f5f9 100%); }
    .example-box { border-left-color: #0891b2; background: linear-gradient(to top, #a5f3fc 0%, #cffafe 100%); }
    .construction-box { border-left-color: #ea580c; background: linear-gradient(to top, #fed7aa 0%, #ffedd5 100%); }
    .notation-box { border-left-color: #ca8a04; background: linear-gradient(to top, #fef08a 0%, #fef9c3 100%); }
    .exercise-box { border-left-color: #ea580c; background: linear-gradient(to top, #fed7aa 0%, #ffedd5 100%); }
    .problem-box { border-left-color: #ec4899; background: linear-gradient(to top, #fbcfe8 0%, #fce7f3 100%); }
    .theorem-header {
      margin-bottom: 0.75em;
      font-size: 1.05em;
      font-weight: 600;
    }
    .theorem-header.clickable {
      cursor: pointer;
      user-select: none;
    }
    .theorem-header.clickable:hover {
      background: rgba(0,0,0,0.03);
      margin: -0.5em -0.75em 0.75em -0.75em;
      padding: 0.5em 0.75em;
      border-radius: 4px;
    }
    .collapsible-icon {
      display: inline-block;
      transition: transform 0.2s ease;
      font-size: 0.75em;
      margin-right: 0.5em;
      color: #6b7280;
    }
    .collapsible-box.collapsed .collapsible-icon {
      transform: rotate(-90deg);
    }
    .collapsible-content {
      transition: max-height 0.3s ease;
      overflow: hidden;
    }
    .collapsible-box.collapsed .collapsible-content {
      display: none;
    }
    .theorem-content {
      padding-left: 0.5em;
      line-height: 1.8;
    }
    .proof-box {
      margin: 1.5em 0;
      border: 1px solid #e5e7eb;
      border-radius: 6px;
      background: white;
      box-shadow: 0 1px 2px rgba(0,0,0,0.05);
    }
    .proof-header {
      position: sticky;
      top: 0;
      background: linear-gradient(to bottom, #fafafa 0%, #f5f5f5 100%);
      border-bottom: 1px solid #e5e7eb;
      z-index: 100;
      border-radius: 6px 6px 0 0;
    }
    .proof-toggle {
      width: 100%;
      padding: 0.85em 1.25em;
      border: none;
      background: transparent;
      text-align: left;
      cursor: pointer;
      font-family: inherit;
      font-size: 1em;
      display: flex;
      align-items: center;
      gap: 0.75em;
      transition: background 0.15s;
    }
    .proof-toggle:hover { background: rgba(0,0,0,0.03); }
    .proof-toggle-icon {
      display: inline-block;
      transition: transform 0.2s ease;
      font-size: 0.75em;
      color: #6b7280;
    }
    .proof-box.collapsed .proof-toggle-icon {
      transform: rotate(-90deg);
    }
    .proof-content {
      padding: 1.25em;
      line-height: 1.8;
    }
    .proof-box.collapsed .proof-content {
      display: none;
    }
    .proof-end {
      float: right;
      font-size: 1.3em;
      margin-left: 0.5em;
      color: #374151;
    }
    .subproof {
      margin: 1em 0;
      border: 1px solid #d1d5db;
      border-radius: 4px;
      background: #f9fafb;
    }
    .subproof-header {
      background: linear-gradient(to bottom, #f9fafb 0%, #f3f4f6 100%);
      border-bottom: 1px solid #d1d5db;
      border-radius: 4px 4px 0 0;
    }
    .subproof-toggle {
      width: 100%;
      padding: 0.6em 1em;
      border: none;
      background: transparent;
      text-align: left;
      cursor: pointer;
      font-family: inherit;
      font-size: 0.95em;
      display: flex;
      align-items: center;
      gap: 0.5em;
      transition: background 0.15s;
    }
    .subproof-toggle:hover {
      background: rgba(0,0,0,0.03);
    }
    .subproof-toggle-icon {
      display: inline-block;
      transition: transform 0.2s ease;
      font-size: 0.7em;
      color: #6b7280;
    }
    .subproof.collapsed .subproof-toggle-icon {
      transform: rotate(-90deg);
    }
    .subproof-content {
      padding: 1em;
      line-height: 1.7;
    }
    .subproof.collapsed .subproof-content {
      display: none;
    }
    .ref-link {
      color: #2563eb;
      text-decoration: none;
      font-weight: 500;
      padding: 0 0.15em;
      border-radius: 2px;
    }
    .ref-link:hover {
      background: #dbeafe;
      text-decoration: underline;
    }
    .ref-unknown {
      color: #dc2626;
      font-weight: bold;
      background: #fee2e2;
      padding: 0.1em 0.3em;
      border-radius: 3px;
    }
    strong { font-weight: 600; }
    em { font-style: italic; }
    ol, ul {
      margin: 1em 0;
      padding-left: 2.5em;
      line-height: 1.8;
    }
    li {
      margin: 0.5em 0;
    }
    .latex-image {
      max-width: 100%;
      height: auto;
      display: block;
      margin: 1.5em auto;
    }
    .latex-figure .latex-image {
      display: inline-block;
      margin: 0.5em;
      vertical-align: middle;
    }
    .latex-figure {
      margin: 2em 0;
      text-align: center;
      line-height: 0;
    }
    .latex-figure .figure-content {
      margin-bottom: 0.75em;
      line-height: normal;
    }
    .latex-figure .figure-content > * {
      vertical-align: middle;
    }
    .latex-figure figcaption {
      font-size: 0.9em;
      color: #4b5563;
      font-style: italic;
      margin-top: 0.5em;
    }
  </style>
</head>
<body>
  <div class="page-layout">
    <nav class="sidebar">
      <div class="sidebar-header">
        <h1>Analysis III</h1>
        <div class="subtitle">Measure Theory &amp; Integration</div>
        <a href="../index.html" class="back-link">‚Üê Table of Contents</a>
      </div>
      <div class="sidebar-nav">
        <div class="chapter-group expanded">
          <div class="chapter-title" onclick="toggleChapter(this)"><span>1. Measure Theory</span><span class="toggle">‚ñ∂</span></div>
          <div class="section-list">
            <a href="../01-measure-theory/measure-theory.html" class="section-link">Overview</a>
            <a href="../01-measure-theory/basics.html" class="section-link">Outer Measures</a>
            <a href="../01-measure-theory/lebesgue-meas.html" class="section-link">Lebesgue Measure</a>
            <a href="../01-measure-theory/cantor.html" class="section-link">The Cantor Set</a>
            <a href="../01-measure-theory/measure-spaces.html" class="section-link">Measure Spaces</a>
          </div>
        </div>
        <div class="chapter-group">
          <div class="chapter-title" onclick="toggleChapter(this)"><span>2. Integration</span><span class="toggle">‚ñ∂</span></div>
          <div class="section-list">
            <a href="../02-integration/integration.html" class="section-link">Overview</a>
            <a href="../02-integration/integrals-1.html" class="section-link">Simple Functions</a>
            <a href="../02-integration/integrals-2.html" class="section-link">General Functions</a>
            <a href="../02-integration/convergence.html" class="section-link">Convergence Theorems</a>
            <a href="../02-integration/inequality-party.html" class="section-link">Integral Inequalities</a>
            <a href="../02-integration/lp_spaces.html" class="section-link">L·µñ Spaces</a>
          </div>
        </div>
        <div class="chapter-group">
          <div class="chapter-title" onclick="toggleChapter(this)"><span>3. Product Measures</span><span class="toggle">‚ñ∂</span></div>
          <div class="section-list">
            <a href="../03-fubini/fubini_ch.html" class="section-link">Overview</a>
            <a href="../03-fubini/fubini.html" class="section-link">Fubini-Tonelli</a>
            <a href="../03-fubini/integrals-3.html" class="section-link">Product Measures</a>
          </div>
        </div>
        <div class="chapter-group">
          <div class="chapter-title" onclick="toggleChapter(this)"><span>4. Differentiation I</span><span class="toggle">‚ñ∂</span></div>
          <div class="section-list">
            <a href="../04-differentiation-1/differentiation.html" class="section-link">Overview</a>
            <a href="../04-differentiation-1/covering.html" class="section-link">Vitali Covering</a>
            <a href="../04-differentiation-1/monotone.html" class="section-link">Monotone Functions</a>
            <a href="../04-differentiation-1/BV_on_R.html" class="section-link">Bounded Variation</a>
            <a href="../04-differentiation-1/FTOC.html" class="section-link">FTC for Lebesgue</a>
            <a href="../04-differentiation-1/HL.html" class="section-link">Hardy-Littlewood</a>
          </div>
        </div>
        <div class="chapter-group">
          <div class="chapter-title" onclick="toggleChapter(this)"><span>5. Differentiation I (cont)</span><span class="toggle">‚ñ∂</span></div>
          <div class="section-list">
            <a href="../05-differentiation-1/differentiation.html" class="section-link">Overview</a>
            <a href="../05-differentiation-1/r-nik.html" class="section-link">Radon-Nikodym</a>
          </div>
        </div>
        <div class="chapter-group">
          <div class="chapter-title" onclick="toggleChapter(this)"><span>6. Differentiation II</span><span class="toggle">‚ñ∂</span></div>
          <div class="section-list">
            <a href="../06-differentiation-2/diff-2.html" class="section-link">Overview</a>
            <a href="../06-differentiation-2/vector-measures.html" class="section-link">Vector Measures</a>
            <a href="../06-differentiation-2/r-nik.html" class="section-link">Radon-Nikodym</a>
            <a href="../06-differentiation-2/besi.html" class="section-link">Besicovitch</a>
            <a href="../06-differentiation-2/densities.html" class="section-link">Densities</a>
            <a href="../06-differentiation-2/diff-measures.html" class="section-link">Measure Derivatives</a>
          </div>
        </div>
        <div class="chapter-group">
          <div class="chapter-title" onclick="toggleChapter(this)"><span>7. Riesz Representation</span><span class="toggle">‚ñ∂</span></div>
          <div class="section-list">
            <a href="../06-riesz/riesz.html" class="section-link">Overview</a>
            <a href="../06-riesz/riesz_functional.html" class="section-link">Riesz Representation</a>
            <a href="../06-riesz/LCH_spaces.html" class="section-link">LCH Spaces</a>
          </div>
        </div>
        <div class="chapter-group">
          <div class="chapter-title" onclick="toggleChapter(this)"><span>8. Integral Formulas</span><span class="toggle">‚ñ∂</span></div>
          <div class="section-list">
            <a href="../07-formulas/formulas.html" class="section-link">Overview</a>
            <a href="../07-formulas/hausdorff_meas.html" class="section-link">Hausdorff Measures</a>
            <a href="../07-formulas/lippy.html" class="section-link">Lipschitz Maps</a>
            <a href="../07-formulas/rademacher.html" class="section-link">Rademacher</a>
            <a href="../07-formulas/coarea-prereq.html" class="section-link">Coarea Prerequisites</a>
            <a href="../07-formulas/coarea.html" class="section-link">Coarea Formula</a>
            <a href="../07-formulas/area-prereq.html" class="section-link">Area Prerequisites</a>
            <a href="../07-formulas/area-formula.html" class="section-link">Area Formula</a>
          </div>
        </div>
        <div class="chapter-group">
          <div class="chapter-title" onclick="toggleChapter(this)"><span>9. Extension Results</span><span class="toggle">‚ñ∂</span></div>
          <div class="section-list">
            <a href="../08-ext-res/ext-res.html" class="section-link">Overview</a>
            <a href="../08-ext-res/taylor_thm_integral_remainder.html" class="section-link">Taylor's Theorem</a>
            <a href="../08-ext-res/whitney-cover.html" class="section-link">Whitney Covering</a>
            <a href="../08-ext-res/whitney-partition-of-unity.html" class="section-link">Partition of Unity</a>
            <a href="../08-ext-res/whitney-decomposition.html" class="section-link">Decomposition</a>
            <a href="../08-ext-res/whitney-extension-theorem.html" class="section-link">Extension Theorem</a>
            <a href="../08-ext-res/whitney-extension-proof.html" class="section-link">Extension Proof</a>
            <a href="../08-ext-res/whitney-extension-applications.html" class="section-link">Applications</a>
            <a href="../08-ext-res/whitney-extension.html" class="section-link">Summary</a>
            <a href="../08-ext-res/more-bump.html" class="section-link">More Bump Functions</a>
          </div>
        </div>
      </div>
    </nav>
    
    <main class="main-content">
      <h2>Deomposition of Open Sets into Cubes</h2>
<p>In this section, we will construct a particularly nice decomposition of an open set into almost disjoint cubes.
We will then use this decomposition to construct a nice partition of unity for the open set, which will be a crucial tool for defining the extension operators in the next section.</p>
<h3>The Whitney Decomposition</h3>
<div class="theorem-box definition-box" id="def:dyadic_cubes">
  <div class="theorem-header"><strong>Definition ?</strong> (Dyadic Cubes)</div>
  <div class="theorem-content">For each $k \in \Z$, we let $\mathcal{D}_k$ be the collection of all dyadic closed cubes of the form
\[ Q = \{ (x_1, \ldots, x_n) \in\R^n :m_j 2^{-k} \leq x_j \leq (m_j+1) 2^{-k} \text{ for } j=1,\ldots,n \} \]
where $m_j \in \Z$ for each $j=1,\ldots,n$.
<p>The set of all dyadic cubes is defined as $\mathcal{D} = \bigcup_{k\in \Z} \mathcal{D}_k$.</div>
</div></p>
<div class="theorem-box exercise-box" id="ex:dyadic_cubes">
  <div class="theorem-header"><strong>Exercise ?</strong> (Basic Facts about Dyadic Cubes)</div>
  <div class="theorem-content"><ol style="list-style-type: lower-roman;"><li>Let $k\in \Z$. 
            For each $Q \in \mathcal{D}_k$ there exists $2^n$ almost disjoint cubes $Q_1, \ldots, Q_{2^n} \in \mathcal{D}_{k+1}$ such that $Q = \bigcup_{j=1}^{2^n} Q_j$.
<p></li><li>If $Q,Q' \in \mathcal{D}$ are such that the interiors of $Q$ and $Q'$ have nonempty intersection, then either $Q \subseteq Q'$ or $Q' \subseteq Q$.
            In other words, the dyadic cubes are either almost disjoint or one is contained in the other.</p>
<p></li><li>Let $k\in \Z$. For each $Q \in \mathcal{D}_k$ there are exactly $3^n - 1$ other cubes in $\mathcal{D}_k$ which intersect $Q$.</li></ol></div>
</div></p>
<div class="proof-box collapsed" data-proof-id="proof-num-0">
  <div class="proof-header">
    <button class="proof-toggle" onclick="toggleProof('proof-num-0')" aria-expanded="false">
      <span class="proof-toggle-icon">‚ñº</span>
      <strong>Proof</strong>
    </button>
  </div>
  <div class="proof-content" id="proof-num-0">
    <ol><li>Let $Q \in \mathcal{D}_k$ be given by
            \[ Q = \{ (x_1, \ldots, x_n) \in\R^n :m_j 2^{-k} \leq x_j \leq (m_j+1) 2^{-k} \text{ for } j=1,\ldots,n \}. \]
            For each $j=1,\ldots,n$, we define the intervals
            \[ I_j^0 = [m_j 2^{-k}, (m_j + \tfrac{1}{2}) 2^{-k}] \qquad \text{and} \qquad I_j^1 = [(m_j + \tfrac{1}{2}) 2^{-k}, (m_j + 1) 2^{-k}]. \]
            Then we can define the cube $Q_{(i_1, \ldots, i_n)}$ for each $i_j \in \{0,1\}$ by
            \[ Q_{(i_1, \ldots, i_n)} = I_1^{i_1} \times \cdots \times I_n^{i_n}. \]
            Then we have 
            \[Q = \bigcup_{i_1, \ldots, i_n \in \{0,1\}} Q_{(i_1, \ldots, i_n)}, \]
            and the collection of cubes $\{Q_{(i_1, \ldots, i_n)}\}_{i_j \in \{0,1\}}$ are pairwise almost disjoint and belong to $\mathcal{D}_{k+1}$.
            Furthermore, there are $2^n$ such cubes, as claimed.
<p></li><li>Let $Q,Q' \in \mathcal{D}$ be such that $Q \cap Q' \neq \varnothing$.
            Then there exist $k,k' \in \Z$ such that $Q \in \mathcal{D}_k$ and $Q' \in \mathcal{D}_{k'}$.
            Without loss of generality, we can assume that $k \leq k'$. 
            We write $Q$ and $Q'$ as
            \[ Q = \prod_{j=1}^n [m_j 2^{-k}, (m_j+1) 2^{-k}] \qquad \text{and} \qquad Q' = \prod_{j=1}^n [m'_j 2^{-k'}, (m'_j+1) 2^{-k'}] \]
            for some integers $m_1, \ldots, m_n$ and $m'_1, \ldots, m'_n$.</p>
<p>Since the interiors of $Q$ and $Q'$ have nonempty intersection, there exists a point $x = (x_1, \ldots, x_n)$ in their common interior. 
            Then for each $j=1,\ldots,n$, we have
            \[ m_j 2^{-k} < x_j < (m_j + 1) 2^{-k} \qquad \text{and}\qquad  m'_j 2^{-k'} < x_j < (m'_j + 1) 2^{-k'}. \]
            Since $k \leq k'$, we have $2^{-k} \geq 2^{-k'}$, and so for each $j=1,\ldots,n$ the interval $[m_j 2^{-k}, (m_j+1) 2^{-k}]$ contains the interval $[m'_j 2^{-k'}, (m'_j + 1) 2^{-k'}]$.
            Therefore, we have $Q' \subseteq Q$, as claimed.</p>
<p></li><li>Write
            \[ Q = \prod_{i=1}^n [m_i 2^{-k},(m_i+1)2^{-k}] \]
            for some $(m_1,\dots,m_n)\in\mathbb{Z}^n$. 
            If 
            \[ Q' = \prod_{i=1}^n [m_i' 2^{-k},(m_i'+1)2^{-k}] \in \mathcal{D}_k \]
            is such that $Q' \cap Q \neq \varnothing$, then for each $j=1,\dots,n$ we must have $|m_j - m_j'| \leq 1$, so that $m'_j \in \{m_j-1,m_j,m_j+1\}$.</p>
<p>Thus if $Q' \in \mathcal{D}_k$ is such that $Q' \cap Q \neq \varnothing$, then there are $3^n$ possible choices for the vector $(m_1',\dots,m_n')$, and hence there are $3^n$ cubes in $\mathcal{D}_k$ which intersect $Q$.
            However, one of these cubes is $Q$ itself, so there are exactly $3^n - 1$ other cubes in $\mathcal{D}_k$ which intersect $Q$ as claimed.</li></ol>
    <span class="proof-end">‚ñ°</span>
  </div>
</div></p>
<div class="theorem-box definition-box" id="def:adjacent_cubes">
  <div class="theorem-header"><strong>Definition ?</strong> (Adjacent Cubes)</div>
  <div class="theorem-content">Two cubes $Q,Q' \subset \R^n$ are said to be adjacent if $Q$ and $Q'$ are almost disjoint but $\partial Q \cap \partial Q' \neq \varnothing$.
    In other words, $Q$ and $Q'$ are adjacent if their interiors are disjoint but they share a common boundary point.</div>
</div>
<div class="theorem-box proposition-box" id="thm:whitney_decomposition">
  <div class="theorem-header"><strong>Proposition ?</strong> (Whitney Decomposition)</div>
  <div class="theorem-content">Let $A \subset \R^n$ be a non-empty proper closed subset.
    Then there exists a countable collection of almost disjoint dyadic closed cubes $\{Q_j\}_{j=1}^\infty$ such that
    <ol style="list-style-type: lower-alpha;"><li>$\displaystyle A^c = \bigcup_{j=1}^\infty Q_j$, and
        </li><li>for each $j\in\Z^+$, we have \[ \diam Q_j \leq \dist(Q_j, A) \leq 4 \diam Q_j. \]</li></ol>
    As a consequence, note that
    <ol style="list-style-type: lower-alpha;" start="3">
        </li><li>if $j,k\in\Z^+$ are such that $Q_j$ and $Q_k$ are adjacent, then 
            \[ \frac{1}{4} \leq \frac{\diam Q_j}{\diam Q_k} \leq 4. \]</li></ol>
    As a further consequence, note that
    <ol style="list-style-type: lower-alpha;" start="4">
        </li><li>for each $j\in\Z^+$, there are at most $12^n - 4^n$ cubes in the collection which are adjacent to $Q_j$.</li></ol>
    The collection of dyadic cubes $\{Q_j\}_{j=1}^\infty$ is called a <em>Whitney decomposition</em> of the open set $A^c$.</div>
</div>
<p>In other words, the key property (b) says the size of a cube in the Whitney decomposition is comparable to its distance from the set $A$.</p>
<div class="proof-box collapsed" data-proof-id="proof-proof-of-a-and-b-">
  <div class="proof-header">
    <button class="proof-toggle" onclick="toggleProof('proof-proof-of-a-and-b-')" aria-expanded="false">
      <span class="proof-toggle-icon">‚ñº</span>
      <strong>Proof of (a) and (b)</strong>
    </button>
  </div>
  <div class="proof-content" id="proof-proof-of-a-and-b-">
    For each $k \geq 1$, we let 
    \[ \Omega_k := \left\{ x\in A^c : 2\sqrt{n} 2^{-k} < \dist(x, A) \leq 4 \sqrt{n}\cdot 2^{-k} \right\} \]
    and see that $ \displaystyle A^c = \bigcup_{k=1}^\infty \Omega_k$.
<p>We define $\mathcal{F}$ to be the collection of all closed cubes $Q \subset \R^n$ such that there exists $k \geq 1$ such that $Q \in \mathcal{D}_k$ and $Q \cap \Omega_k \neq \varnothing$.
    We claim that propery (b) holds for the cubes in $\mathcal{F}$.</p>
<p>Let $Q \in \mathcal{F}$, and let $k\geq 1$ be such that $Q \in \mathcal{D}_k$ and $Q \cap \Omega_k \neq \varnothing$.
    Then choose $x \in Q \cap \Omega_k$, and observe that
    \begin{align*} 
        \diam Q = \sqrt{n}2^{-k} &\leq \dist(x, A) - \sqrt{n}2^{-k} \\
            &= \dist(x, A) - \diam Q \\
            &\leq \dist(Q,A) \\
            &\leq 4\sqrt{n}2^{-k} \\
            &= 4\diam Q 
    \end{align*}
    which gives \[ \diam Q \leq \dist(Q,A) \leq 4\diam Q \]
    as claimed.</p>
<p>We also claim that
    \[ A^c = \bigcup_{Q\in \mathcal{F}} Q. \]
    Note that each cube in $\mathcal{F}$ is contained in $A^c$, since it has distance at least $\diam Q$ from $A$.
    Thus we have $\bigcup_{Q\in \mathcal{F}} Q \subseteq A^c$.</p>
<p>Conversely, let $x \in A^c$ be given.
    Then there exists $k\geq 1$ such that $x \in \Omega_k$, and so there exists a cube $Q \in \mathcal{D}_k$ such that $x \in Q$.
    Since $x \in \Omega_k$, we have $\dist(x, A) > 2\sqrt{n} 2^{-k}$, and so $Q \cap \Omega_k \neq \varnothing$.
    Thus $Q \in \mathcal{F}$, and so $x \in \bigcup_{Q\in \mathcal{F}} Q$.
    Since $x$ was arbitrary, we have $A^c \subseteq \bigcup_{Q\in \mathcal{F}} Q$, and so $A^c = \bigcup_{Q\in \mathcal{F}} Q$ as claimed.</p>
<p><div style="margin: 1em 0;"></div></p>
<p>Thus the collection $\mathcal{F}$ satisfies properties (a) and (b).
    The problem is that the cubes in $\mathcal{F}$ are not almost disjoint.
    Recall that by Exercise <span class="ref-unknown" title="Reference not found: ex:dyadic_cubes">[ex:dyadic_cubes?]</span>, if $Q_1, Q_2 \in \mathcal{F}$ and $Q_1^\circ \cap Q_2^\circ \neq \varnothing$, then either $Q_1 \subseteq Q_2$ or $Q_2 \subseteq Q_1$.
    That is, two cubes in $\mathcal{F}$ either have disjoint interiors or one is contained in the other.</p>
<p>Therefore for each cube $Q \in \mathcal{F}$, we let $Q^{\text{max}}$ be the maximal cube in $\mathcal{F}$ which contains $Q$; such a cube exists an is unique by the previous observation.
    By maximality and our previous observation, the maximal cubes have pairwise disjoint interiors, and hence are almost disjoint.
    Noting that the collection $\mathcal{F}$ is countable, we can enumerate the maximal cubes as $\{Q_j\}_{j=1}^\infty$.
    Then $\{Q_j\}_{j=1}^\infty$ is a Whitney cover of $A^c$ because
    <ul><li>the cubes $\{ Q_j\}_{j=1}^\infty$ are almost disjoint by construction;
        </li><li>we have $\displaystyle A^c = \bigcup_{Q\in \mathcal{F}} Q = \bigcup_{j=1}^\infty Q_j$; and
        </li><li>each cube $Q_j$ belongs to $\mathcal{F}$, and hence satisfies $\diam Q_j \leq \dist(Q_j, A) \leq 4\diam Q_j$.</li></ul>
    <span class="proof-end">‚ñ°</span>
  </div>
</div></p>
<div class="proof-box collapsed" data-proof-id="proof-proof-of-c-and-d-">
  <div class="proof-header">
    <button class="proof-toggle" onclick="toggleProof('proof-proof-of-c-and-d-')" aria-expanded="false">
      <span class="proof-toggle-icon">‚ñº</span>
      <strong>Proof of (c) and (d)</strong>
    </button>
  </div>
  <div class="proof-content" id="proof-proof-of-c-and-d-">
    <ol style="list-style-type: lower-alpha;" start="3">
        </li><li>Suppose $j,k \geq 1$ are such that the cubes $Q_j$ and $Q_k$ are adjacent.
            Then $Q_j$ and $Q_k$ are almost disjoint, but $\partial Q_j \cap \partial Q_k \neq \varnothing$, and so $\dist(Q_j,Q_k) = 0$.
            Then we see that
            \[ \diam Q_j \leq \dist(Q_j, A) \leq \dist(Q_j, Q_k) + \dist(Q_k, A) \leq 0 + 4\diam Q_k \]
            which gives $\diam Q_j \leq 4\diam Q_k$.
<p>By symmetry, we also have $\diam Q_k \leq 4\diam Q_j$, and hence 
            \[\frac{1}{4} \leq \frac{\diam Q_j}{\diam Q_k} \leq 4\]
            as desired.</p>
<p></li><li>Let $j\in\Z^+$ be arbitrary. 
            Note that the largest number of dyadic cubes adjacent to $Q_j$ is obtained when all of the adjacent cubes have the smallest possible size.
            By part (c), the smallest possible size of a cube adjacent to $Q_j$ is $\frac{1}{4}\diam Q_j$.</p>
<p>We claim that for each $Q \in \mathcal{D}_k$ there are at most $4^n$ cubes in $\{Q_j\}_{j=1}^\infty$ with diameter $\geq \frac{1}{4}\diam Q$ which are contained in $Q$.</p>
<div class="subproof collapsed" data-subproof-id="subproof-1763576799687-0">
      <div class="subproof-header">
        <button class="subproof-toggle" onclick="toggleSubproof('subproof-1763576799687-0')" aria-expanded="false">
          <span class="subproof-toggle-icon">‚ñº</span>
          <strong>Proof of Claim</strong>
        </button>
      </div>
      <div class="subproof-content" id="subproof-1763576799687-0">
        Let $Q \in \mathcal{D}_k$ be arbitrary.
            Then each cube $Q_j$ with $\diam Q_j \geq \frac{1}{4}\diam Q$ which is contained in $Q$ must belong to $\mathcal{D}_k$, or $\mathcal{D}_{k-1}$, or $\mathcal{D}_{k-2}$.
            We cannot have $Q_j \in \mathcal{D}_{k-3}$ because then $\diam Q_j < \frac{1}{4}\diam Q$, and we cannot have $Q_j \in \mathcal{D}_{k+1}$ because then $\diam Q_j > 4\diam Q$ and hence $Q_j$ cannot be contained in $Q$.
<p>In the first case, there is a unique cube in $\mathcal{D}_k$ which is equal to $Q$, so there is at most one cube in $\{Q_j\}_{j=1}^\infty$ with diameter $\geq \frac{1}{4}\diam Q$ which is contained in $Q$ and belongs to $\mathcal{D}_k$.</p>
<p>In the second case where $Q_j \in \mathcal{D}_{k-1}$, there are at most $2^n$ cubes in $\mathcal{D}_{k-1}$ which are contained in $Q$, and hence at most $2^n$ cubes in $\{Q_j\}_{j=1}^\infty$ with diameter $\geq \frac{1}{4}\diam Q$ which are contained in $Q$ and belong to $\mathcal{D}_{k-1}$.</p>
<p>In the third case where $Q_j \in \mathcal{D}_{k-2}$, there are at most $4^n$ cubes in $\mathcal{D}_{k-2}$ which are contained in $Q$, and hence at most $4^n$ cubes in $\{Q_j\}_{j=1}^\infty$ with diameter $\geq \frac{1}{4}\diam Q$ which are contained in $Q$ and belong to $\mathcal{D}_{k-2}$.
        <span class="proof-end">‚ñ°</span>
      </div>
    </div></p>
<p>Combining the previous claim with exercise <span class="ref-unknown" title="Reference not found: ex:dyadic_cubes">[ex:dyadic_cubes?]</span> (c) shows that there are at most $4^n(3^n-1)=12^n - 4^n$ cubes in the collection which are adjacent to $Q_j$.</li></ol>
    <span class="proof-end">‚ñ°</span>
  </div>
</div></p>
<div class="theorem-box corollary-box" id="cor:whitney_cover_dilation">
  <div class="theorem-header"><strong>Corollary ?</strong></div>
  <div class="theorem-content">Let $A \subseteq \R^n$ be a non-empty proper closed subset, and let $\{Q_j\}_{j=1}^\infty$ be the Whitney decomposition of $A^c$ given by Proposition <span class="ref-unknown" title="Reference not found: thm:whitney_decomposition">[thm:whitney_decomposition?]</span>.
<p>Fix $0 < \varepsilon < \frac{2}{5}$. 
    For each $j\in\Z^+$, let $Q_j^* = (1+\varepsilon) Q_j$ be the cube obtained by dilating $Q_j$ by a factor of $1+\varepsilon$ about its center.</p>
<p><div style="margin: 1em 0;"></div></p>
<p><span class="noindent"></span>Then for each $j\in\Z^+$, we have $Q_j^* \subseteq A^c$.
    Also if $j,k\in\Z^+$ are such that $Q_j \cap Q_k = \varnothing$, then $Q_j^* \cap Q^*_k = \varnothing$.</p>
<p>Furthermore, 
    \[ \Chi_{A^c} \leq \sum_{j=1}^\infty \Chi_{Q^*_j} \leq 2^n\Chi_{A^c}. \]</div>
</div></p>
<div class="proof-box collapsed" data-proof-id="proof-num-3">
  <div class="proof-header">
    <button class="proof-toggle" onclick="toggleProof('proof-num-3')" aria-expanded="false">
      <span class="proof-toggle-icon">‚ñº</span>
      <strong>Proof</strong>
    </button>
  </div>
  <div class="proof-content" id="proof-num-3">
    Let $j\in\Z^+$ be arbitrary.
    Then we have $Q_j^* = (1+\varepsilon) Q_j$, and since each cube adjacent to $Q_j$ has diameter at least $\frac{1}{4}\diam Q_j$, we see that $Q_j^*$ is contained in the union of $Q_j$ and the cubes adjacent to $Q_j$.
    Since each cube adjacent to $Q_j$ is contained in $A^c$, we have $Q_j^* \subseteq A^c$ as claimed.
<p>Moreover, see that 
    \[ A^c = \bigcup_{j=1}^\infty Q_j \subseteq \bigcup_{j=1}^\infty Q_j^* \]
    implies that 
    \[ \Chi_{A^c} \leq \Chi_{\bigcup_{j=1}^\infty Q_j^*} = \sum_{j=1}^\infty \Chi_{Q_j^*} \]
    which is the first inequality.</p>
<p><div style="margin: 1em 0;"></div></p>
<p>Suppose now that $j,k\in\Z^+$ are such that $Q_j \cap Q_k = \varnothing$.
    Then $Q_j$ and $Q_k$ are not adjacent, and since $Q_j^*$ is contained in the union of $Q_j$ and the cubes adjacent to $Q_j$, we have $Q_j^* \cap Q_k = \varnothing$. 
    We claim that in fact $Q_j^* \cap Q_k^* = \varnothing$.</p>
<div class="subproof collapsed" data-subproof-id="subproof-1763576799687-0">
      <div class="subproof-header">
        <button class="subproof-toggle" onclick="toggleSubproof('subproof-1763576799687-0')" aria-expanded="false">
          <span class="subproof-toggle-icon">‚ñº</span>
          <strong>Proof of Claim</strong>
        </button>
      </div>
      <div class="subproof-content" id="subproof-1763576799687-0">
        Since $Q_j^*$ is contained in the union of $Q_j$ and the cubes adjacent to $Q_j$, and since $Q_k^*$ is contained in the union of $Q_k$ and the cubes adjacent to $Q_k$, we see that for the intersection $Q_j^* \cap Q_k^*$ to be nonempty, there must be a cube in the Whitney decomposition which is adjacent to both $Q_j$ and $Q_k$.
        Let $Q_l$ be a cube in the Whitney decomposition which is adjacent to both $Q_j$ and $Q_k$.
        Then by part (c) of Proposition <span class="ref-unknown" title="Reference not found: thm:whitney_decomposition">[thm:whitney_decomposition?]</span>, we have
        \[ \frac{1}{4} \leq \frac{\diam Q_j}{\diam Q_l} \leq 4 \qquad \text{and} \qquad \frac{1}{4} \leq \frac{\diam Q_k}{\diam Q_l} \leq 4. \]
        Without loss of generality, we can assume that $\diam Q_j \leq \diam Q_k$.
        Then we must have $\diam Q_k \leq 16 \diam Q_j$ by combining the previous inequalities, which implies that 
        \[ \diam Q_k = c\cdot \diam Q_j \qquad\text{for some } c \in \{ 1,2, 4, 8, 16\}. \]
        <strong>DRAW PICTURE</strong>
<p>Assume that $\diam Q_k = \diam Q_j$.
        Then $Q_j$ and $Q_k$ are non-adjacent dyadic cubes in $\mathcal{D}_N$ for some $N\in\Z$, and hence must have $\dist(Q_j, Q_k) \geq 2^{-N} = \ell(Q_j)$.
        (Why? The dyadic cubes in $\mathcal{D}_N$ are arranged in a grid, and two cubes in $\mathcal{D}_k$ are adjacent or separated by at least one cube in $\mathcal{D}_N$.)
        Hence, the cubes $Q_j^*$ and $Q_k^*$ have a positive distance
        \begin{align*}
            \dist(Q_j^* ,Q_k^*) &> \dist\left( \left(\frac{7}{5}Q_j\right) , \left(\frac{7}{5}Q_k\right) \right) \\
                &\geq \dist(Q_j ,Q_k) - \frac{1}{2}\frac{2}{5}\ell(Q_j) - \frac{1}{2}\frac{2}{5}\ell(Q_k) \\
                &\geq \ell(Q_j) - \frac{1}{5}\ell(Q_j) - \frac{1}{5}\ell(Q_k) \\
                &= \frac{3}{5}\ell(Q_j) > 0
        \end{align*}
        where the first inequality follows from the fact that $Q_j^* = (1+\varepsilon) Q_j$ and $1 + \varepsilon < \frac{7}{5}$, and the second inequality follows from the triangle inequality.</p>
<p>Now assume that $\diam Q_k = 2 \diam Q_j$.
        Then $Q_j$ and $Q_k$ are non-adjacent dyadic cubes in $\mathcal{D}_{N+1}$ and $\mathcal{D}_{N}$ respectively for some $N\in\Z$, and hence must have $\dist(Q_j, Q_k) \geq 2^{-N-1} = \frac{1}{2}\ell(Q_k)$.
        (Why? Since $Q_k\in \mathcal{D}_{N}$ we see that $Q_k$ is a union of $2^n$ cubes in $\mathcal{D}_{N+1}$, and hence by identical reasoning as in the previous case with one of these cubes in $\mathcal{D}_{N+1}$ we see that $Q_j$ and $Q_k$ must be separated by at least one cube in $\mathcal{D}_{N+1}$, which has side length $\ell(Q_j) = \frac{1}{2}\ell(Q_k)$.)
        Hence the cubes $Q_j^*$ and $Q_k^*$ have a positive distance
        \begin{align*}
            \dist(Q_j^* ,Q_k^*) &> \dist\left( \left(\frac{7}{5}Q_j\right) , \left(\frac{7}{5}Q_k\right) \right) \\
                &\geq \dist(Q_j ,Q_k) - \frac{1}{2}\frac{2}{5}\ell(Q_j) - \frac{1}{2}\frac{2}{5}\ell(Q_k) \\
                &\geq \frac{1}{2}\ell(Q_k) - \frac{1}{5}\ell(Q_j) - \frac{1}{5}\ell(Q_k) \\
                &= \frac{3}{10}\ell(Q_k) - \frac{1}{10}\ell(Q_k) = \frac{1}{5}\ell(Q_k) > 0.
        \end{align*}</p>
<p>Now assume that $\diam Q_k = 4 \diam Q_j$.
        Then $Q_j$ and $Q_k$ are non-adjacent dyadic cubes in $\mathcal{D}_{N+2}$ and $\mathcal{D}_{N}$ respectively for some $N\in\Z$, and hence must have $\dist(Q_j, Q_k) \geq 2^{-N-2} = \frac{1}{4}\ell(Q_k)$.
        (Why? Since $Q_k\in \mathcal{D}_{N-2}$ we see that $Q_k$ is a union of $2^{2n}$ cubes in $\mathcal{D}_{N}$, and hence by identical reasoning as in the previous case with one of these cubes in $\mathcal{D}_{N}$ we see that $Q_j$ and $Q_k$ must be separated by at least one cube in $\mathcal{D}_{N}$, which has side length $\ell(Q_j)$.)
        Hence the cubes $Q_j^*$ and $Q_k^*$ have a positive distance
        \begin{align*}
            \dist(Q_j^* ,Q_k^*) &> \dist\left( \left(\frac{7}{5}Q_j\right) , \left(\frac{7}{5}Q_k\right) \right) \\
                &\geq \dist(Q_j ,Q_k) - \frac{1}{2}\frac{2}{5}\ell(Q_j) - \frac{1}{2}\frac{2}{5}\ell(Q_k) \\
                &\geq \frac{1}{4}\ell(Q_k) - \frac{1}{5}\ell(Q_j) - \frac{1}{5}\ell(Q_k) \\
                &= \frac{5}{20} \ell(Q_k) - \frac{1}{20}\ell(Q_k) - \frac{4}{20}\ell(Q_k) = 0.
        \end{align*}</p>
<p>In the cases that $\diam Q_k = 8 \diam Q_j$ or $\diam Q_k = 16 \diam Q_j$, the cubes $Q_j$ and $Q_k$ must have distance at least $ \frac{1}{4}\ell(Q_k)$, because the smallest cube adjacent to $Q_k$ has side length at least $\frac{1}{4}\ell(Q_k)$.
        In these cases, the cubes $Q^*_j$ and $Q^*_k$ have a positive distance, as 
        \begin{align*}
            \dist(Q_j^* ,Q_k^*) &\geq \dist\left( \left(\frac{7}{5}Q_j\right) , \left(\frac{7}{5}Q_k\right) \right) \\
                &\geq \dist(Q_j ,Q_k) - \frac{1}{2}\frac{2}{5}\ell(Q_j) - \frac{1}{2}\frac{2}{5}\ell(Q_k) \\
                &\geq \frac{1}{4}\ell(Q_k) - \frac{1}{5}\ell(Q_j) - \frac{1}{5}\ell(Q_k) \\
                &= \frac{1}{20}\ell(Q_k) - \frac{1}{5}\ell(Q_j) 
        \end{align*}
        and in the case $\diam Q_k = 8 \diam Q_j$ we have $\ell(Q_j) = \frac{1}{8}\ell(Q_k)$, and in the case $\diam Q_k = 16 \diam Q_j$ we have $\ell(Q_j) = \frac{1}{16}\ell(Q_k)$, so that in either case we have $\dist(Q_j^* ,Q_k^*) > 0$.</p>
<p>This case analysis shows that if $Q_j \cap Q_k = \emptyset$, then $Q_j^*$ and $Q_k^*$ are disjoint, as claimed.
        <span class="proof-end">‚ñ°</span>
      </div>
    </div></p>
<p>It remains to prove the final inequality.</p>
<p><div style="margin: 1em 0;"></div></p>
<p>We claim that the maximum number of pairwise adjacent cubes in the Whitney decomposition such that their dilations by a factor of $1+\varepsilon$ contain a common point is at most $2^n$.</p>
<div class="subproof collapsed" data-subproof-id="subproof-1763576799687-1">
      <div class="subproof-header">
        <button class="subproof-toggle" onclick="toggleSubproof('subproof-1763576799687-1')" aria-expanded="false">
          <span class="subproof-toggle-icon">‚ñº</span>
          <strong>Proof of Claim</strong>
        </button>
      </div>
      <div class="subproof-content" id="subproof-1763576799687-1">
        Assume that there are cubes $Q_{j_1}, \ldots, Q_{j_M}$ in the Whitney decomposition, and that the intersection of their dilations is nonempty, i.e. $Q_{j_1}^* \cap \cdots \cap Q_{j_M}^* \neq \emptyset$.
        By the contrapositive of the previous claim, we see that the intersection of any pair of cubes in the collection $\{Q_{j_1}, \ldots, Q_{j_M}\}$ is nonempty.
        If $M < 2^n$, then we are done.
        The only way to have $M \geq 2^n$ is if the cubes $Q_{j_1}, \ldots, Q_{j_M}$ all have a common corner vertex, and hence are all adjacent to each other, and this forces $M = 2^n$.
        <span class="proof-end">‚ñ°</span>
      </div>
    </div>
<p>In particular, for each point $x \in A^c$, there are at most $2^n$ cubes in the collection $\{Q_j^*\}_{j=1}^\infty$ which contain $x$, and hence
    \[ \sum_{j=1}^\infty \Chi_{Q_j^*}(x) \leq 2^n \]
    for each $x \in A^c$ as claimed.</p>
<p>If $x \in A$, then $x$ cannot belong to any of the cubes in the Whitney decomposition (as their union equals $A^c$), and hence for each $j\in\Z^+$ we have $x \notin Q_j^*$, since $Q_j^*$ is contained in the union of $Q_j$ and the cubes adjacent to $Q_j$.
    Thus, for each $x \in A$, we have $\sum_{j=1}^\infty \Chi_{Q_j^*}(x) = 0$, so that
    \[ \sum_{j=1}^\infty \Chi_{Q_j^*}(x) = 0 = 2^n \Chi_{A^c}(x) \]
    as claimed.</p>
<p>This completes the proof of the final inequality, and hence the proof of the corollary.
    <span class="proof-end">‚ñ°</span>
  </div>
</div></p>
    </main>
  </div>
  
  <script>
    function toggleChapter(element) {
      element.parentElement.classList.toggle('expanded');
    }
    
    // Highlight current page in sidebar
    document.addEventListener('DOMContentLoaded', () => {
      const currentPath = window.location.pathname;
      const links = document.querySelectorAll('.section-link');
      links.forEach(link => {
        if (currentPath.endsWith(link.getAttribute('href').split('/').pop())) {
          link.classList.add('active');
          // Expand parent chapter
          const group = link.closest('.chapter-group');
          if (group) group.classList.add('expanded');
        }
      });
    });
    
    window.addEventListener('DOMContentLoaded', () => {
      console.log('Restoring proof collapse states...');
      try {
        const openProofs = JSON.parse(localStorage.getItem('openProofs') || '{}');
        const currentPage = window.location.pathname;
        const pageOpen = openProofs[currentPage] || [];
        
        console.log('Current page:', currentPage);
        console.log('Open proof IDs stored:', pageOpen);
        console.log('Found ' + pageOpen.length + ' open proofs for this page');
        
        document.querySelectorAll('.proof-box').forEach(box => {
          const proofId = box.getAttribute('data-proof-id');
          console.log('Checking proof:', proofId, 'Should be open:', pageOpen.includes(proofId));
          if (pageOpen.includes(proofId)) {
            box.classList.remove('collapsed');
            const button = box.querySelector('.proof-toggle');
            button.setAttribute('aria-expanded', 'true');
          } else {
            box.classList.add('collapsed');
            const button = box.querySelector('.proof-toggle');
            button.setAttribute('aria-expanded', 'false');
          }
        });
        
        const openBoxes = JSON.parse(localStorage.getItem('openBoxes') || '{}');
        const pageBoxes = openBoxes[currentPage] || [];
        
        console.log('Open box IDs stored:', pageBoxes);
        
        document.querySelectorAll('.collapsible-box').forEach(box => {
          const boxId = box.getAttribute('data-collapsible-id');
          console.log('Checking box:', boxId, 'Should be open:', pageBoxes.includes(boxId));
          if (pageBoxes.includes(boxId)) {
            box.classList.remove('collapsed');
          } else {
            box.classList.add('collapsed');
          }
        });
        
        console.log('Proof states restored');
      } catch (e) {
        console.error('Error restoring collapse state:', e);
      }
    });
    
    function toggleProof(proofId) {
      const proofContent = document.getElementById(proofId);
      const proofBox = proofContent.closest('.proof-box');
      proofBox.classList.toggle('collapsed');
      
      const button = proofBox.querySelector('.proof-toggle');
      button.setAttribute('aria-expanded', !proofBox.classList.contains('collapsed'));
      
      saveProofState();
    }
    
    function toggleSubproof(subproofId) {
      const subproofContent = document.getElementById(subproofId);
      const subproof = subproofContent.closest('.subproof');
      subproof.classList.toggle('collapsed');
      
      const button = subproof.querySelector('.subproof-toggle');
      button.setAttribute('aria-expanded', !subproof.classList.contains('collapsed'));
    }
    
    function saveProofState() {
      try {
        const currentPage = window.location.pathname;
        const openProofs = JSON.parse(localStorage.getItem('openProofs') || '{}');
        if (!openProofs[currentPage]) {
          openProofs[currentPage] = [];
        }
        
        openProofs[currentPage] = [];
        document.querySelectorAll('.proof-box:not(.collapsed)').forEach(box => {
          const proofId = box.getAttribute('data-proof-id');
          if (proofId) {
            openProofs[currentPage].push(proofId);
          }
        });
        
        localStorage.setItem('openProofs', JSON.stringify(openProofs));
        console.log('Saved proof state (open proofs):', openProofs[currentPage]);
      } catch (e) {
        console.error('Error saving collapse state:', e);
      }
    }
    
    function toggleCollapsible(collapsibleId) {
      const content = document.getElementById(collapsibleId);
      const box = content.closest('.collapsible-box');
      box.classList.toggle('collapsed');
      
      saveCollapsibleState();
    }
    
    function saveCollapsibleState() {
      try {
        const currentPage = window.location.pathname;
        const openBoxes = JSON.parse(localStorage.getItem('openBoxes') || '{}');
        if (!openBoxes[currentPage]) {
          openBoxes[currentPage] = [];
        }
        
        openBoxes[currentPage] = [];
        document.querySelectorAll('.collapsible-box:not(.collapsed)').forEach(box => {
          const boxId = box.getAttribute('data-collapsible-id');
          if (boxId) {
            openBoxes[currentPage].push(boxId);
          }
        });
        
        localStorage.setItem('openBoxes', JSON.stringify(openBoxes));
      } catch (e) {
        console.error('Error saving box state:', e);
      }
    }
    
    document.addEventListener('keydown', (e) => {
      if (e.key === 'p' && e.ctrlKey) {
        e.preventDefault();
        const proofBoxes = document.querySelectorAll('.proof-box');
        const anyExpanded = Array.from(proofBoxes).some(box => !box.classList.contains('collapsed'));
        
        proofBoxes.forEach(box => {
          if (anyExpanded) {
            box.classList.add('collapsed');
          } else {
            box.classList.remove('collapsed');
          }
        });
        
        saveProofState();
      }
    });
    
    document.querySelectorAll('a.ref-link').forEach(link => {
      link.addEventListener('click', (e) => {
        e.preventDefault();
        const targetId = link.getAttribute('href').substring(1);
        const target = document.getElementById(targetId);
        if (target) {
          target.scrollIntoView({ behavior: 'smooth', block: 'center' });
          target.style.background = '#fef3c7';
          target.style.transition = 'background 0.3s ease';
          setTimeout(() => { target.style.background = ''; }, 1500);
        }
      });
    });
  </script>
</body>
</html>